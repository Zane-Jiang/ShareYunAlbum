(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-admin-adminPictureAudit"],{1318:function(t,i,n){var e=n("6c9c");"string"===typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);var a=n("4f06").default;a("d10f1b86",e,!0,{sourceMap:!1,shadowMode:!1})},"132c":function(t,i,n){"use strict";n.r(i);var e=n("5ee2"),a=n.n(e);for(var o in e)["default"].indexOf(o)<0&&function(t){n.d(i,t,(function(){return e[t]}))}(o);i["default"]=a.a},"24a8":function(t,i,n){"use strict";n.r(i);var e=n("d1ce"),a=n("132c");for(var o in a)["default"].indexOf(o)<0&&function(t){n.d(i,t,(function(){return a[t]}))}(o);n("7818");var c,s=n("f0c5"),l=Object(s["a"])(a["default"],e["b"],e["c"],!1,null,"191a217c",null,!1,e["a"],c);i["default"]=l.exports},"5ee2":function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,n("a434");var e={data:function(){return{picsWarning:[],dict:["序号","图片id","上传者","违禁类别","备注","缩略图","操作"],onAuditing:!1,temp_pic_display:null,ivDict:{politics:"涉政",porn:"涉黄",terrorism:"恐怖"}}},methods:{autoAuditPic:function(){var t=this;this.onAuditing=!0,console.log("图片审核"),setTimeout((function(){t.onAuditing=!1}),1e3),this.getAllPicId()},previewImg:function(t){null!==t&&void 0!==t&&uni.previewImage({urls:[t]})},getAllPicId:function(){var t=this,i={option:"getAllPictureId"};this.$http.post(this.$api.admin,i).then((function(t){var i=t.data.getAllPictureId;return i})).then((function(i){console.log(i);for(var n=0;n<i.length;n++)t.auditOneByOne(i[n])})).catch((function(t){console.log(t),alert("图片id获取失败")}))},auditOneByOne:function(t){var i=this,n={option:"autoReviewPicture",pic_id:t};this.$http.post(this.$api.admin,n).then((function(t){console.log(t.data);var i=t.data.result;return i})).then((function(n){i.addInValidPic(t,n)})).catch((function(i){console.log(i),alert(t+"检测失败")}))},addInValidPic:function(t,i){var n=this,e=[],a="";if("pass"!==i.suggestion){var o=i.categorySuggestions;for(var c in o)"pass"!==o[c]&&(e.push(this.ivDict[c]),"politics"===c&&(a=i.detail.politics[0].label));var s=e.join();console.log(s),this.getInValidPic(t),this.$http.post(this.$api.admin,{option:"getPictureInfo",pic_id:t}).then((function(t){var i=t.data.Picture,e={pic_id:"**"+i.pic_id.substring(i.pic_id.length-7),pic_owner:"**"+i.pic_album.substring(i.pic_album.length-7),label:a,inValidType:s,thumbnail:n.temp_pic_display};console.log(e),n.picsWarning.push(e)})).catch((function(t){console.log(t),alert("图片信息获取失败")}))}},getInValidPic:function(t){var i=this,n={option:"download",pic_id:t};this.$http.download(this.$api.admin,{params:n}).then((function(t){console.log(t),i.temp_pic_display=t.tempFilePath})).catch((function(t){console.log(t),alert("图片获取失败")}))},whiteList:function(t){this.picsWarning.splice(t,1)},deletePic:function(t){var i=this,n=this.picsWarning[t];console.log(n),uni.showModal({title:"提示",content:"是否删除该图片",confirmText:"删除",confirmColor:"red",cancelText:"取消",success:function(e){var a={option:"deletePicture",pic_id:n.pic_id};i.$http.post(i.$api.admin,a).then((function(n){var e=n.data.status;switch(e){case"100":uni.showToast({title:"删除成功"}),i.picsWarning.splice(t,1);break;case"101":alert("删除失败");break}})).catch((function(t){console.log(t),alert("删除请求出错")}))},fail:function(t){console.log(t),alert("删除操作失败")}})}}};i.default=e},"6c9c":function(t,i,n){var e=n("24fb");i=e(!1),i.push([t.i,".option-btns[data-v-191a217c]{display:flex;justify-content:space-around}.page[data-v-191a217c]{max-width:1200px;margin:75px auto;background-color:#fff;height:100%;font-size:20px;padding:40px;box-shadow:0 0 20px #306230}.inline-text[data-v-191a217c]{font-size:20px}.thumbnail[data-v-191a217c]{width:60px;height:60px;cursor:pointer}",""]),t.exports=i},7818:function(t,i,n){"use strict";var e=n("1318"),a=n.n(e);a.a},d1ce:function(t,i,n){"use strict";var e;n.d(i,"b",(function(){return a})),n.d(i,"c",(function(){return o})),n.d(i,"a",(function(){return e}));var a=function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("v-uni-view",{staticClass:"page"},[n("v-uni-button",{attrs:{loading:t.onAuditing,disabled:t.onAuditing,type:"primary"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.autoAuditPic.apply(void 0,arguments)}}},[t._v(t._s(t.onAuditing?"等待中":"自动审核"))]),n("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:0!==t.picsWarning.length,expression:"picsWarning.length !== 0"}]},[n("table",{staticClass:"pure-table pure-table-bordered"},[n("tr",t._l(t.dict,(function(i){return n("th",{key:i},[t._v(t._s(i))])})),0),t._l(t.picsWarning,(function(i,e){return n("tr",{key:e},[n("td",[t._v(t._s(e+1))]),n("td",[t._v(t._s(i.pic_id))]),n("td",[t._v(t._s(i.pic_owner))]),n("td",[t._v(t._s(i.inValidType))]),n("td",[t._v(t._s(i.label))]),n("td",[n("v-uni-image",{staticClass:"thumbnail",attrs:{src:i.thumbnail,mode:"aspectFill",title:"点击放大"},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.previewImg(i.thumbnail)}}})],1),n("td",[n("v-uni-view",{staticClass:"option-btns"},[n("v-uni-view",{staticClass:"delete-option",attrs:{title:"删除"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.deletePic(e)}}}),n("v-uni-view",{staticClass:"accept-option",attrs:{title:"设置白名单"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.whiteList(e)}}})],1)],1)])}))],2)])],1)},o=[]}}]);